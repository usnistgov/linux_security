id: networking_ensure_rtc_utc_configuration
title: Ensure real-time clock is set to UTC
discussion: |
  If time stamps are not consistently applied and there is no common
  time reference, it is difficult to perform forensic analysis.

  Time stamps generated by the operating system include date and time.
  Time is commonly expressed in UTC, a modern continuation of GMT, or
  local time with an offset from UTC.
check: $OS_VALUE
result:
  integer: 1
fix: $OS_VALUE
references:
  cce:
    - $OS_VALUE
  cci:
    - CCI-001890
  800-53r4:
    - N/A
  srg:
    - SRG-OS-000359-GPOS-00146
  disa_stig:
    - $OS_VALUE
  cis:
    benchmark:
      - $OS_VALUE
tags:
  - N/A
severity: high
os_specifics:
  ubuntu:
    '2004':
      references:
        cce:
          - N/A
        disa_stig:
          - UBTU-20-010230
      check:
        - N/A
      fix: |
        [source,bash]
        ---
        # Remediation is applicable only in certain platforms
        if dpkg-query --show --showformat='${db:Status-Status}
        ' 'linux-base' 2>/dev/null | grep -q ^installed; then

        if timedatectl status | grep -i "time zone" | grep -iv 'UTC\|GMT'; then
            timedatectl set-timezone UTC
        fi

        else
            >&2 echo 'Remediation is not applicable, nothing was done'
        fi

        ---
    '2204':
      references:
        cce:
          - N/A
        disa_stig:
          - UBTU-22-252020
      check:
        - N/A
      fix: |
        [source,bash]
        ---
        # Remediation is applicable only in certain platforms
        if dpkg-query --show --showformat='${db:Status-Status}
        ' 'linux-base' 2>/dev/null | grep -q ^installed; then

        if timedatectl status | grep -i "time zone" | grep -iv 'UTC\|GMT'; then
            timedatectl set-timezone UTC
        fi

        else
            >&2 echo 'Remediation is not applicable, nothing was done'
        fi

        ---
